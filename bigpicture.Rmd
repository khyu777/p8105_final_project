---
title: "Big Picture"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

###Introduction

In the continued fight against HIV/AIDS, New York City is instrumental in upholding the New York state plan to ends the AIDS epidemic by 2020. To guide this progress, we must be able to understand both the level of burden and the improvements made over time.

This page is dedicated visualizations that highlight big picture analyses  of HIV's impact on New York City:

```{r setup, include=FALSE}
#Loading libraries:

library(tidyverse)
library(patchwork)

theme_set(theme_bw() + theme(legend.position = "bottom"))

#Loading the data:
  
hiv_data = read_csv("./data/DOHMH_HIV_AIDS_Annual_Report.csv") %>% 
  janitor::clean_names()
```

### Death Rates (By Relation to HIV) Over the Years

How much HIV contributes to the overall death rate in New York City over the years can illustrate how the combined effects of implemented interventions, policies, and strategies have altered the effects of HIV.

The following stacked bar graph highlights the extent to which deaths related to HIV/AIDS contribute to the overall number of deaths per 1,000 people, mid-year, living with HIV/AIDS. Changes in the contribution of HIV-related deaths are shown from the years 2011 to 2015.

```{r death rates by type, echo = FALSE, message=FALSE, warning=FALSE}
#Original code by Bryce, further edited by Bryce

#Cleaning the data to just look at times, controlling for gender, age, race, borough, and UHF:

hiv_year_data = hiv_data %>% 
  filter(
    borough == "All",
    uhf == "All",
    gender == "All",
    age == "All",
    race == "All"
  )

#Mapping all outcome variables on the same graph.

#First gathering several outcome variables of interest into one outcome variable:

all_death_rates = hiv_year_data %>% 
  gather(key = death_rate_type, value = death_rate_nums, death_rate:non_hiv_related_death_rate) %>% 
  filter(death_rate_nums != 99999)

#Making a stacked bar graph.

stacked_death_plot = all_death_rates %>% 
  filter(death_rate_type != "death_rate")

ggplot(stacked_death_plot, aes(x = year, y = death_rate_nums, group = death_rate_type)) +   
  geom_col(aes(fill = death_rate_type)) +
  labs(
    title = "Death rates types over the years",
    x = "Year",
    y = "Rate"
  )
```

Talk about our findings.

###HIV Diagnosis by Borough

In addressing how to further direct HIV/AIDS efforts in New York City, it is particularly useful to be able to identify how the impact of HIV is distributed across the city's geographic regions. Taking a look at how this distribution has changed over time may also serve to highlight where additional attention and resources need to be allocated.   

In the bar graph below, we assess the number of HIV diagnoses per 100,000 NYC residents within each borough, between the years 2011 and 2015.

```{r HIV diagnosis by boro, echo = FALSE, message=FALSE, warning=FALSE}
#Original code by Noah, edited by Bryce

#Filtering original data to look at summary observations across demographic variables for each borough

HIV_diagnosis_data = hiv_data %>%
  filter(uhf %in% c("All")) %>%
  filter(borough != "All") %>%
  filter(gender == "All") %>%
  filter(age == "All")

#Plotting a bar graph looking at diagnoses rate each year for each borough

HIV_diagnosis_data %>%
  ggplot( aes(fill = reorder(borough, -hiv_diagnosis_rate), y = hiv_diagnosis_rate, x = year)) +
  geom_bar(position = "dodge", stat = "identity") + 
  labs(title = "HIV Diagnosis Rate by Borough over Time", y = "HIV Diagnosis Rate", x = "Year", fill = "Borough")
```

Talk about findings.

###Conclusion
